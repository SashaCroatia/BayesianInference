% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MH.R
\name{metropolis}
\alias{metropolis}
\title{Adaptive Metropolis-Hastings Sampler for Logistic Regression
Runs a (potentially adaptive) Metropolis-Hastings MCMC algorithm for sampling regression coefficients in a logistic regression model. Supports Gaussian priors or KDE-based empirical priors, and can update the proposal distribution adaptively in batches.}
\usage{
metropolis(
  X,
  y,
  N = 20000,
  prior = TRUE,
  update = FALSE,
  KDE = FALSE,
  C = NA,
  den_funs = NA,
  M = ncol(X),
  a_target = 0.234,
  b1 = rep(0, M),
  batch = TRUE,
  batch_schedule = seq(50, N, by = 50)
)
}
\arguments{
\item{X}{Numeric matrix of predictors (\eqn{n \times M}).}

\item{y}{Numeric vector or single-column matrix of binary responses (0/1).}

\item{N}{Integer. Total number of MCMC iterations (default = 20000).}

\item{prior}{Logical. If \code{TRUE}, includes a prior term in the posterior calculation (default = TRUE).}

\item{update}{Logical. If \code{TRUE}, proposed samples are taken from the provided chain \code{C} rather than the proposal distribution (default = FALSE).}

\item{KDE}{Logical. If \code{TRUE}, uses a KDE-based prior via \code{\link{log_prior_kde}}; otherwise uses Gaussian prior via \code{\link{log_prior}} (default = FALSE).}

\item{C}{Numeric matrix. Previous posterior samples used for KDE prior (if \code{KDE = TRUE}) or for replaying proposals if \code{update = TRUE}.}

\item{den_funs}{List of functions. Each function returns a density value for a given coefficient (only used if \code{KDE = TRUE}).}

\item{M}{Integer. Number of predictors (default = \code{ncol(X)}).}

\item{a_target}{Numeric. Target acceptance rate for adaptation (default = 0.234).}

\item{b1}{Numeric vector of length \code{M}. Initial value of regression coefficients (default = \code{rep(0, M)}).}

\item{batch}{Logical. If \code{TRUE}, adapts proposal covariance in batches; otherwise uses single-step Robbinsâ€“Monro adaptation (default = TRUE).}

\item{batch_schedule}{Integer vector. Iterations at which batch updates occur (default = \code{seq(50, N, by = 50)}).}
}
\value{
A numeric matrix of posterior samples for regression coefficients, with the first 10\\% discarded as burn-in.
}
\description{
Adaptive Metropolis-Hastings Sampler for Logistic Regression
Runs a (potentially adaptive) Metropolis-Hastings MCMC algorithm for sampling regression coefficients in a logistic regression model. Supports Gaussian priors or KDE-based empirical priors, and can update the proposal distribution adaptively in batches.
}
\details{
The algorithm follows an adaptive Metropolis-Hastings framework:
\enumerate{
\item Propose a new sample from a multivariate normal proposal distribution (\code{\link{proposal}}).
\item Compute the acceptance ratio using the logistic regression likelihood (\code{\link{logistic_ll}})
plus the specified prior.
\item Accept or reject the proposal according to the Metropolis criterion.
\item Adapt the proposal distribution to improve mixing, either in batches or incrementally.
}
If \code{KDE = TRUE}, the prior is estimated from previous MCMC output \code{C} by fitting kernel density
estimates for each coefficient separately.
}
